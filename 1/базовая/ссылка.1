#!1
системная
используется
  базовая/структура
  базовая/синтаксис
  базовая/функция
используется-для-синтаксиса
  базовая/синтаксис
  базовая/функция
предоставлять ссылка в в! ссылка+

структура %ссылка
  ; запись
    чтение
    сдвиг
    позиция

определение-синтаксиса ссылка(выражение)
  выбор-синтаксиса выражение ()
    (_ коллекция[ключ])
      #' %ссылка
        функция (ссылка значение)
          коллекция[%ссылка-позиция(ссылка)] := значение
        функция (ссылка)
          коллекция[%ссылка-позиция(ссылка)]
        функция (ссылка число)
          копия-структуры %ссылка ссылка (позиция ; %ссылка-позиция(ссылка) + число)
        ключ
    (_ выражение-ссылки)
      #' %ссылка
        функция (ссылка значение)
          выражение-ссылки := значение
        функция (ссылка)
          выражение-ссылки
        функция (ссылка число)
          вызвать-ошибку "Арифметика доступна только у указателей на элемент массива"
        0

в ссылка =
  %ссылка-чтение(ссылка)(ссылка)

в! ссылка значение =
  %ссылка-запись(ссылка)(ссылка значение)

ссылка+ ссылка число =
  %ссылка-сдвиг(ссылка)(ссылка число)
