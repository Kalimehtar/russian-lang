#!1
системная
используется
  с-префиксом rkt: racket/base
  с-префиксом mt: racket/match
предоставлять список список* список? пара пара? пустой? пустой-список первый оставшиеся \
  в-списке в-списке=== отобразить для-каждого длина развернуть хвост-списка :

mt:define-match-expander список
  функция (выражение)
    выбор-синтаксиса выражение ()
      (_ образец ...)
         #'(list образец ...)
  функция (выражение)
    выбор-синтаксиса выражение ()
      (_ образец ...)
         #'(rkt:list образец ...)
      _ #'(rkt:procedure-rename rkt:list (цитата список))

mt:define-match-expander список*
  функция (выражение)
    выбор-синтаксиса выражение ()
      (_ образец ...)
         #'(list* образец ...)
  функция (выражение)
    выбор-синтаксиса выражение ()
      (_ образец ...)
         #'(rkt:list* образец ...)
      _ #'(rkt:procedure-rename rkt:list* (цитата список*))

mt:define-match-expander пара
  функция (выражение)
    выбор-синтаксиса выражение ()
      (_ образец ...)
         #'(cons образец ...)
  функция (выражение)
    выбор-синтаксиса выражение ()
      (_ образец ...)
         #'(rkt:cons образец ...)
      _ #'(rkt:procedure-rename rkt:cons (цитата пара))

а : б =
  пара а б

список? объект =
  rkt:list? объект

пара? объект =
  rkt:pair? объект

пустой? список =
  rkt:null? список

первый список =
  rkt:car список

оставшиеся список =
  rkt:cdr список

пустой-список = rkt:null

в-списке значение список =
  rkt:member значение список

в-списке=== значение список =
  rkt:memv значение список

отобразить функция . списки =
  rkt:apply rkt:map функция списки

для-каждого функция . списки =
  rkt:apply rkt:for-each функция списки

длина список =
  rkt:length список

развернуть список =
  rkt:reverse список

хвост-списка список количество =
  rkt:list-tail список количество